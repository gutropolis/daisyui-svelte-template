import{p as e,Z as t,u as a,i,f as s,c as d,r as l,g as r,n as o,e as n,b as p,j as c,_ as f,t as u,h as b,v as x,a as m,D as g,F as y,$ as v,d as h,q as w,X as k,a0 as D,m as T,R as N,S as _,U as L,w as C,k as q,x as A,y as F,z as I}from"../chunks/O-IopRwW.js";import{c as S}from"../chunks/pgnebUR0.js";import{r as Y}from"../chunks/DVfzy2eF.js";var E=s('<input type="text" class="w-full border border-gray-300 rounded px-2 py-1 text-sm"/> <div class="flex gap-2 mt-2 text-xs"><button class="px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded">Today</button> <button class="px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded">M-D-Y</button></div>',1),j=s('<textarea class="w-full border border-gray-300 rounded px-2 py-1 text-sm" rows="2"></textarea>'),M=s('<div class="space-y-2"><div class="flex items-center gap-2"><input type="radio" id="opt1" class="w-4 h-4"/> <label for="opt1" class="text-sm">Option 1</label></div> <div class="flex items-center gap-2"><input type="radio" id="opt2" class="w-4 h-4"/> <label for="opt2" class="text-sm">Option 2</label></div></div>'),P=s('<input type="text" class="w-full border border-gray-300 rounded px-2 py-1 text-sm"/>'),B=s('<div class="bg-gray-50 border border-gray-300 rounded p-4"><div class="flex items-start gap-3"><div class="flex flex-col gap-1"><button class="text-gray-400 hover:text-gray-600" title="Move up"><i class="fas fa-chevron-up text-xs"></i></button> <i class="fas fa-ellipsis-v text-gray-400 text-xs"></i> <button class="text-gray-400 hover:text-gray-600" title="Move down"><i class="fas fa-chevron-down text-xs"></i></button></div> <div class="flex-1"><div class="flex items-start gap-3"><div class="flex gap-1 pt-1"><button class="text-orange-500 hover:text-orange-700 text-sm" title="Edit"><i class="fas fa-pen"></i></button> <button class="text-green-500 hover:text-green-700 text-sm" title="Copy"><i class="fas fa-copy"></i></button> <button class="text-blue-500 hover:text-blue-700 text-sm" title="Branching"><i class="fas fa-code-branch"></i></button> <button class="text-gray-500 hover:text-gray-700 text-sm" title="Lock"><i class="fas fa-lock"></i></button> <button class="text-red-500 hover:text-red-700 text-sm" title="Delete"><i class="fas fa-times"></i></button></div> <div class="flex-1"><p class="text-xs text-gray-600 italic"> </p> <h3 class="text-base font-bold text-gray-900 mb-3"> </h3> <div class="bg-white border border-gray-300 rounded p-3 min-h-20"><!></div> <div class="flex gap-2 mt-3 border-t border-gray-300 pt-3"><button class="px-2 py-1 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Field</button> <button class="px-2 py-1 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Matrix of Fields</button> <button class="px-2 py-1 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Import from Field Bank</button></div></div></div></div></div></div>'),O=s('<div class="fixed inset-0 bg-black bg-opacity-40 flex items-start justify-center z-50 pt-6 pb-6 overflow-y-auto"><div class="bg-white shadow-lg w-full max-w-4xl"><div class="bg-gray-50 border-b border-gray-300 p-4 flex items-center justify-between"><div><button class="px-3 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 flex items-center gap-2"><i class="fas fa-arrow-left"></i> Return to list of instruments</button></div> <button class="text-gray-500 hover:text-gray-700 text-xl" title="Close editor" aria-label="Close editor"><i class="fas fa-times"></i></button></div> <div class="p-6 space-y-6"><div class="bg-blue-50 border border-blue-200 rounded p-4"><p class="text-sm text-gray-700 leading-relaxed">This page allows you to build and customize your data collection instruments one field at a time. You may add new fields or edit existing ones. New fields may be added by clicking the <span class="font-semibold">Add Field</span> buttons. You can begin editing an existing field by clicking on the <span class="font-semibold"><i class="fas fa-pen"></i> Edit</span> icon. If you decide that you do not want to keep a field, you can simply delete it by clicking on the <span class="font-semibold"><i class="fas fa-times text-red-500"></i> Delete</span> icon. To reorder the fields, simply drag and drop a field to a different position within the form below. NOTE: While in development status, all field changes will take effect immediately in real time.</p> <div class="mt-4 flex flex-wrap gap-2"><span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium flex items-center gap-1"><i class="fas fa-check-circle"></i>Smart Variables</span> <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium flex items-center gap-1"><i class="fas fa-code-branch"></i>Piping</span> <span class="px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium flex items-center gap-1"><i class="fas fa-tag"></i>Action Tags</span> <span class="px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs font-medium flex items-center gap-1"><i class="fas fa-layer-group"></i>Field Embedding</span> <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium flex items-center gap-1"><i class="fas fa-bolt"></i>Special Functions</span></div></div> <div><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-bold text-gray-800">Current instrument: <span class="text-red-600"> </span></h2> <button class="px-3 py-2 bg-gray-400 text-white rounded text-sm hover:bg-gray-500">Preview instrument</button></div> <div class="flex gap-2 mb-6 border-b border-gray-300 pb-4"><button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Field</button> <button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Matrix of Fields</button> <button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Import from Field Bank</button></div> <div class="space-y-4"></div> <div class="mt-6 flex gap-2 border-t border-gray-300 pt-4"><button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Field</button> <button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Add Matrix of Fields</button> <button class="px-3 py-2 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700">Import from Field Bank</button></div></div> <div class="absolute right-6 top-32 w-60 bg-white border border-gray-300 rounded p-4 shadow-md"><h3 class="text-sm font-bold text-gray-900 mb-3"><i class="fas fa-lightbulb text-blue-500 mr-2"></i>How to embed a field elsewhere</h3> <p class="text-xs text-gray-700 leading-relaxed mb-3">Learn how to customize your instrument or survey by using <button class="text-blue-600 hover:underline bg-transparent border-0 cursor-pointer p-0">Field Embedding</button>.</p> <h3 class="text-sm font-bold text-gray-900 mb-3 pt-3 border-t border-gray-300"><i class="fas fa-lightbulb text-blue-500 mr-2"></i>How to modify multiple fields together</h3> <p class="text-xs text-gray-700 leading-relaxed">Learn how to quickly modify your fields by editing a <button class="text-blue-600 hover:underline bg-transparent border-0 cursor-pointer p-0">matrix of fields</button>.</p></div></div></div></div>');function U(s,N){e(N,!1);let _=t(N,"instrument",8,null),L=t(N,"onClose",8,()=>{}),C=a(_()?.fields||[]);i();var q=O(),A=d(q),F=d(A),I=d(F),S=d(I);l(I);var Y=r(I,2);l(F);var U=r(F,2),z=r(d(U),2),$=d(z),V=d($),H=r(d(V)),R=d(H,!0);l(H),l(V),o(2),l($);var Z=r($,4);n(Z,7,()=>c(C),e=>e.id,(e,t,a)=>{var i=B(),s=d(i),n=d(s),v=d(n),h=r(v,4);l(n);var N=r(n,2),_=d(N),L=d(_),q=r(d(L),8);l(L);var A=r(L,2),F=d(A),I=d(F);l(F);var S=r(F,2),Y=d(S,!0);l(S);var O=r(S,2),U=d(O),z=e=>{var t=E();o(2),m(e,t)},$=e=>{var a=g(),i=y(a),s=e=>{var t=j();m(e,t)},n=e=>{var a=g(),i=y(a),s=e=>{var a=M(),i=d(a),s=d(i);o(2),l(i);var n=r(i,2),p=d(n);o(2),l(n),l(a),u(()=>{T(s,"name",(c(t),f(()=>`field_${c(t).id}`))),T(p,"name",(c(t),f(()=>`field_${c(t).id}`)))}),m(e,a)},n=e=>{var t=P();m(e,t)};p(i,e=>{c(t),f(()=>"radio"===c(t).fieldType||"checkbox"===c(t).fieldType)?e(s):e(n,!1)},!0),m(e,a)};p(i,e=>{c(t),f(()=>"text"===c(t).fieldType)?e(s):e(n,!1)},!0),m(e,a)};p(U,e=>{c(t),f(()=>"date"===c(t).fieldType)?e(z):e($,!1)}),l(O),o(2),l(A),l(_),l(N),l(s),l(i),u(()=>{b(I,`Variable: ${c(t),f(()=>c(t).fieldName)??""}`),b(Y,(c(t),f(()=>c(t).fieldLabel)))}),x("click",v,()=>(e=>{var t,a;e>0&&(t=[c(C)[e-1],c(C)[e]],a=k(t,2),D(C,c(C)[e]=a[0]),D(C,c(C)[e-1]=a[1]),w(C,c(C)))})(c(a))),x("click",h,()=>(e=>{var t,a;e<c(C).length-1&&(t=[c(C)[e+1],c(C)[e]],a=k(t,2),D(C,c(C)[e]=a[0]),D(C,c(C)[e+1]=a[1]),w(C,c(C)))})(c(a))),x("click",q,()=>{return e=c(t).id,void w(C,c(C).filter(t=>t.id!==e));var e}),m(e,i)}),l(Z),o(2),l(z),o(2),l(U),l(A),l(q),u(()=>b(R,(v(_()),f(()=>_()?.name)))),x("click",S,function(...e){L()?.apply(this,e)}),x("click",Y,function(...e){L()?.apply(this,e)}),m(s,q),h()}var z=s('<tr><td class="px-4 py-3 font-medium text-gray-900"> </td><td class="text-center px-4 py-3 text-gray-700"> </td><td class="text-center px-4 py-3"><button class="text-red-600 hover:text-red-700" title="Download PDF"><i class="fas fa-file-pdf"></i></button></td><td class="px-4 py-3"><select class="px-3 py-1 border border-gray-300 rounded text-sm bg-white text-gray-700 hover:border-gray-400"><option>Choose action</option><option>Edit</option><option>Preview</option><option>Delete</option><option>Duplicate</option></select></td></tr>'),$=s('<div class="p-6 space-y-6"><div><a class="flex items-center gap-2 text-[#0b3a7a] hover:text-[#082654] text-sm font-medium mb-4"><i class="fas fa-arrow-left"></i>Back to Setup</a> <h1 class="text-3xl font-bold text-gray-800 mb-2">Design Your Data Collection Instruments</h1> <p class="text-gray-600">Add or edit fields on your data collection instruments using the Online Designer</p></div> <div class="bg-[#0b3a7a]/5 border border-[#0b3a7a]/10 rounded-lg p-4 flex items-start gap-3"><i class="fas fa-lightbulb text-[#0b3a7a] mt-1"></i> <div><p class="font-medium text-gray-800">You can design forms by using the Online Designer or by uploading a Data Dictionary.</p> <p class="text-sm text-gray-600 mt-1"><a href="#" class="text-[#0b3a7a] hover:underline">Download the current data dictionary</a></p></div></div> <div class="flex flex-wrap gap-3"><button class="px-4 py-2 bg-[#0b3a7a] text-white rounded-lg hover:bg-[#082654] font-medium transition-colors flex items-center gap-2"><i class="fas fa-plus"></i> Online Designer</button> <button class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-medium transition-colors flex items-center gap-2"><i class="fas fa-upload"></i> Data Dictionary</button> <button class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition-colors flex items-center gap-2"><i class="fas fa-download"></i> Download Data Dictionary</button> <button class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium transition-colors flex items-center gap-2"><i class="fas fa-search"></i> Check For Identifiers</button></div> <div class="flex flex-wrap gap-2"><span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium flex items-center gap-1"><i class="fas fa-check-circle"></i>Smart Variables</span> <span class="px-3 py-1 bg-[#0b3a7a]/10 text-[#0b3a7a] rounded-full text-xs font-medium flex items-center gap-1"><i class="fas fa-code-branch"></i>Piping</span> <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium flex items-center gap-1"><i class="fas fa-tag"></i>Action Tags</span> <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-medium flex items-center gap-1"><i class="fas fa-layer-group"></i>Field Embedding</span> <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-xs font-medium flex items-center gap-1"><i class="fas fa-star"></i>Special Functions</span></div> <div class="bg-white rounded-lg shadow overflow-hidden"><div class="p-6 border-b border-gray-200"><h2 class="text-xl font-bold text-gray-800 mb-4">Data Collection Instruments</h2> <div class="bg-gray-100 p-4 rounded border border-gray-300"><p class="text-sm font-medium text-gray-700 mb-3">Add new instrument:</p> <div class="flex flex-wrap gap-3"><button class="px-4 py-2 bg-green-600 text-white rounded text-sm font-medium hover:bg-green-700 flex items-center gap-2"><i class="fas fa-plus"></i>Create <span class="text-xs font-normal">a new instrument from scratch</span></button> <button class="px-4 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 flex items-center gap-2"><i class="fas fa-download"></i>Import <span class="text-xs font-normal">a new instrument from the official <a href="#" class="underline">REDCap Instrument Library</a></span></button> <button class="px-4 py-2 bg-orange-600 text-white rounded text-sm font-medium hover:bg-orange-700 flex items-center gap-2"><i class="fas fa-upload"></i>Upload <span class="text-xs font-normal">instrument ZIP file from another project/user or <a href="#" class="underline">external libraries</a></span></button></div></div></div> <div class="overflow-x-auto"><table class="w-full text-sm border-collapse"><thead><tr class="bg-gray-200 border-b border-gray-400"><th class="text-left px-4 py-3 font-bold text-gray-900">Instrument name</th><th class="text-center px-4 py-3 font-bold text-gray-900">Fields</th><th class="text-center px-4 py-3 font-bold text-gray-900">View PDF</th><th class="text-left px-4 py-3 font-bold text-gray-900">Instrument actions</th></tr></thead><tbody></tbody></table></div></div></div> <!>',1);function V(t,a){e(a,!0);const[i,s]=C();let f=_(L([{id:1,name:"Baseline",description:"Initial participant assessment",status:"Active",fields:[{id:1,fieldName:"patient_age",fieldLabel:"Age",fieldType:"number",required:!0},{id:2,fieldName:"patient_gender",fieldLabel:"Gender",fieldType:"radio",required:!0},{id:3,fieldName:"medical_history",fieldLabel:"Medical History",fieldType:"text",required:!1},{id:4,fieldName:"consent",fieldLabel:"Consent",fieldType:"checkbox",required:!0}]},{id:2,name:"Intervention",description:"Intervention form",status:"Active",fields:[{id:5,fieldName:"intervention_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:6,fieldName:"intervention_type",fieldLabel:"Type",fieldType:"dropdown",required:!0}]},{id:3,name:"Checkpoint 30 Day",description:"Checkpoint 30 Day form",status:"Active",fields:[{id:7,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:8,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:9,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:4,name:"Checkpoint 6 Month",description:"Checkpoint 6 Month form",status:"Active",fields:[{id:10,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:11,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:12,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:5,name:"Checkpoint 1 Year",description:"Checkpoint 1 Year form",status:"Active",fields:[{id:13,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:14,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:15,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:6,name:"Student Check Up 1",description:"Student Check Up 1 form",status:"Active",fields:[{id:16,fieldName:"check_date",fieldLabel:"Date",fieldType:"date",required:!0}]},{id:7,name:"Checkpoint 2 Year",description:"Checkpoint 2 Year form",status:"Active",fields:[{id:17,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:18,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:19,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:8,name:"Student Check Up 2",description:"Student Check Up 2 form",status:"Active",fields:[{id:20,fieldName:"check_date",fieldLabel:"Date",fieldType:"date",required:!0}]},{id:9,name:"Checkpoint 3 Year",description:"Checkpoint 3 Year form",status:"Active",fields:[{id:21,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:22,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:23,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:10,name:"Checkpoint 4 Year",description:"Checkpoint 4 Year form",status:"Active",fields:[{id:24,fieldName:"checkpoint_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:25,fieldName:"status",fieldLabel:"Status",fieldType:"radio",required:!0},{id:26,fieldName:"notes",fieldLabel:"Notes",fieldType:"text",required:!1}]},{id:11,name:"Adverse Events",description:"Adverse Events form",status:"Active",fields:[{id:27,fieldName:"event_date",fieldLabel:"Date",fieldType:"date",required:!0},{id:28,fieldName:"event_type",fieldLabel:"Type",fieldType:"dropdown",required:!0}]}])),x=_(!1),g=_(null),v=_(null);const k=A(()=>c(f).find(e=>e.id===c(v))),D=e=>{w(f,c(f).filter(t=>t.id!==e),!0)},N=A(()=>F(I,"$page",i).params.projectId??"1"),E=A(()=>Y(S,c(N)));var j=$(),M=y(j),P=d(M),B=d(P);o(4),l(P);var O=r(P,4);d(O).__click=()=>w(x,!0),o(6),l(O);var V=r(O,4),H=r(d(V),2),R=d(H),Z=r(d(R));n(Z,21,()=>c(f),e=>e.id,(e,t)=>{var a=z();a.__click=()=>w(g,c(t).id,!0);var i=d(a),s=d(i,!0);l(i);var o=r(i),n=d(o,!0);l(o);var p=r(o,2),f=d(p);f.__change=e=>((e,t)=>{const a=e.target,i=a.value;"Edit"===i?w(v,t,!0):"Delete"===i&&D(t),a.value="Choose action"})(e,c(t).id);var x=d(f);x.value=x.__value="Choose action";var y=r(x);y.value=y.__value="Edit";var h=r(y);h.value=h.__value="Preview";var k=r(h);k.value=k.__value="Delete";var T=r(k);T.value=T.__value="Duplicate",l(f),l(p),l(a),u(()=>{q(a,1,"border-b border-gray-300 hover:bg-blue-50 "+(c(g)===c(t).id?"bg-blue-100":"")),b(s,c(t).name),b(n,c(t).fields.length)}),m(e,a)}),l(Z),l(R),l(H),l(V),l(M);var G=r(M,2),W=e=>{U(e,{get instrument(){return c(k)},onClose:()=>w(v,null)})};p(G,e=>{c(v)&&c(k)&&e(W)}),u(()=>T(B,"href",c(E))),m(t,j),h(),s()}N(["click","change"]);export{V as component};
